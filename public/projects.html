<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects - Alexis Hirsch Portfolio</title>
    <link rel="icon" type="image/png" href="Images/Logo.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo">
                <img src="Images/Logo.png" alt="Alexis Hirsch" class="logo-img">
            </a>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/projects">Projects</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <section class="featured-projects" style="padding: 6rem 0;">
            <div class="container">
                <h2 class="section-title">My Projects</h2>
                
                <div class="projects-showcase">
                    <!-- SamePath Project -->
                    <div class="project-showcase-card" data-project="samepath">
                        <div class="showcase-background samepath-bg"></div>
                        <div class="showcase-content">
                            <div class="project-icon-large">üìö</div>
                            <div class="project-text-content">
                                <h2>SamePath</h2>
                                <p class="project-description">A comprehensive mobile application designed to help students connect with classmates, form study groups, and collaborate on academic projects. The platform integrates with university class schedules to automatically suggest study partners based on shared classes and availability.</p>
                                <div class="showcase-buttons">
                                    <button class="btn-screenshots" onclick="openImageCarousel('samepath')">View Screenshots</button>
                                    <a href="https://github.com/ahirsch17/SamePath" target="_blank" class="btn-github">View on GitHub</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RealEstateHirsch Project -->
                    <div class="project-showcase-card" data-project="realestatehirsch">
                        <div class="showcase-background realestatehirsch-bg"></div>
                        <div class="showcase-content layout-right">
                            <div class="project-text-content">
                                <h2>RealEstateHirsch</h2>
                                <p class="project-description">A modern, responsive real estate website showcasing property listings with virtual tours, high-quality photography, and an integrated scheduling system. Built for real estate professionals to manage property displays and client appointments efficiently.</p>
                                <div class="showcase-buttons">
                                    <a href="https://hirsch-leasing.onrender.com/" target="_blank" class="btn-live">Visit Live Site</a>
                                    <a href="https://github.com/ahirsch17/hirsch-properties" target="_blank" class="btn-github">View on GitHub</a>
                                </div>
                            </div>
                            <div class="project-icon-large">üè†</div>
                        </div>
                    </div>

                    <!-- SportsPredictor Project -->
                    <div class="project-showcase-card" data-project="sportspredictor">
                        <div class="showcase-background sportspredictor-bg"></div>
                        <div class="showcase-content">
                            <div class="project-icon-large">üèà</div>
                            <div class="project-text-content">
                                <h2>SportsPredictor</h2>
                                <p class="project-description">An advanced sports prediction system using machine learning algorithms to forecast game outcomes for NFL, MLB, and College Football. Factors in team statistics, player injuries, weather conditions, and historical performance data to generate accurate predictions.</p>
                                <div class="showcase-buttons">
                                    <button class="btn-explore" onclick="openModal('sportspredictor')">Open</button>
                                    <button class="btn-screenshots" onclick="openImageCarousel('sportspredictor')">View Screenshots</button>
                                    <button class="btn-screenshots" onclick="openMatchupReport()">View Matchup Report</button>
                                    <a href="https://github.com/ahirsch17/sportsPredictor" target="_blank" class="btn-github">View on GitHub</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal for SamePath -->
    <div id="modal-samepath" class="modal" onclick="closeModal(event, 'samepath')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal(event, 'samepath')">&times;</span>
            <div class="modal-header">
                <div class="modal-icon">üìö</div>
                <div>
                    <h2>SamePath</h2>
                    <p class="modal-subtitle">Student Collaboration Platform</p>
                </div>
            </div>
            <div class="modal-body">
                <p class="modal-description">SamePath is a comprehensive mobile application designed to help students connect with classmates, form study groups, and collaborate on academic projects. The platform integrates with university class schedules (including Virginia Tech) to automatically suggest study partners based on shared classes and availability.</p>
                
                <h3>Key Features:</h3>
                <ul class="feature-list">
                    <li>Class schedule integration with CRN lookup</li>
                    <li>Automatic study partner matching based on shared classes</li>
                    <li>Group chat functionality for teams</li>
                    <li>Free time discovery and coordination</li>
                    <li>Friends list management</li>
                    <li>User preferences and notifications</li>
                    <li>Contact matching and acceptance flow</li>
                </ul>

                <h3>Technologies Used:</h3>
                <div class="project-tags" style="margin-bottom: 2rem;">
                    <span class="tag">React Native</span>
                    <span class="tag">TypeScript</span>
                    <span class="tag">Python Flask</span>
                    <span class="tag">MongoDB</span>
                    <span class="tag">Express.js</span>
                    <span class="tag">REST API</span>
                </div>

                <div class="modal-links">
                    <a href="https://github.com/ahirsch17/SamePath" target="_blank" class="btn btn-primary">View on GitHub</a>
                    <button class="btn btn-secondary" onclick="openImageCarousel('samepath')">View Screenshots</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for RealEstateHirsch -->
    <div id="modal-realestatehirsch" class="modal" onclick="closeModal(event, 'realestatehirsch')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal(event, 'realestatehirsch')">&times;</span>
            <div class="modal-header">
                <div class="modal-icon">üè†</div>
                <div>
                    <h2>RealEstateHirsch</h2>
                    <p class="modal-subtitle">Professional Real Estate Website</p>
                </div>
            </div>
            <div class="modal-body">
                <p class="modal-description">A modern, responsive real estate website showcasing property listings with virtual tours, high-quality photography, and an integrated scheduling system. Built for real estate professionals to manage property displays and client appointments efficiently.</p>
                
                <h3>Key Features:</h3>
                <ul class="feature-list">
                    <li>Interactive property listings with photo galleries</li>
                    <li>Virtual tour integration</li>
                    <li>Appointment scheduling system with booking management</li>
                    <li>Team member profiles with contact information</li>
                    <li>Contact forms and inquiry management</li>
                    <li>Mobile-responsive design</li>
                    <li>Professional UI with smooth animations</li>
                </ul>

                <h3>Technologies Used:</h3>
                <div class="project-tags" style="margin-bottom: 2rem;">
                    <span class="tag">HTML5</span>
                    <span class="tag">CSS3</span>
                    <span class="tag">JavaScript</span>
                    <span class="tag">Express.js</span>
                    <span class="tag">Node.js</span>
                    <span class="tag">Responsive Design</span>
                </div>



                <div class="modal-links">
                    <a href="https://hirsch-leasing.onrender.com/" target="_blank" class="btn btn-primary">View Live Site</a>
                    <a href="https://github.com/ahirsch17/hirsch-properties" target="_blank" class="btn btn-secondary">View on GitHub</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for SportsPredictor -->
    <div id="modal-sportspredictor" class="modal" onclick="closeModal(event, 'sportspredictor')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal(event, 'sportspredictor')">&times;</span>
            <div class="modal-header">
                <div class="modal-icon">‚öΩ</div>
                <div>
                    <h2>SportsPredictor</h2>
                    <p class="modal-subtitle">ML-Powered Sports Analytics</p>
                </div>
            </div>
            <div class="modal-body">
                <p class="modal-description">Run an NFL detailed matchup prediction or a weekly batch right from this portfolio.</p>
                <div class="project-tags" style="margin-bottom: 1rem;">
                    <span class="tag">Python</span>
                    <span class="tag">Express.js</span>
                    <span class="tag">scikit-learn</span>
                </div>

                <div style="display:grid; gap:1.25rem;">
                    <div class="card" style="padding:1rem; border-radius:12px;">
                        <h3 style="margin:0 0 .5rem 0;">Run NFL Detailed Matchup</h3>
                        <div style="display:grid; gap:.75rem;">
                            <div style="display:grid; gap:.25rem;">
                                <label>Home Team</label>
                                <input id="sp_homeTeam" class="input" placeholder="e.g., Cincinnati Bengals">
                            </div>
                            <div style="display:grid; gap:.25rem;">
                                <label>Away Team</label>
                                <input id="sp_awayTeam" class="input" placeholder="e.g., Chicago Bears">
                            </div>
                            <label style="display:flex; align-items:center; gap:.5rem;">
                                <input id="sp_neutral" type="checkbox"> Neutral site
                            </label>
                            <div style="display:flex; gap:.5rem; flex-wrap:wrap; align-items:center;">
                                <button class="btn" onclick="runMatchupFromModal()">Predict</button>
                                <button class="btn" onclick="openMatchupReport()">View Sample Report</button>
                            </div>
                            <pre id="sp_matchupOutput" style="margin:0; white-space:pre-wrap; font-family:Courier New, monospace; font-size:.9rem; line-height:1.5; background:#0b1220; color:#e5e7eb; padding:1rem; border-radius:10px; min-height:100px; overflow:auto;"></pre>
                        </div>
                    </div>

                    <div class="card" style="padding:1rem; border-radius:12px;">
                        <h3 style="margin:0 0 .5rem 0;">Run NFL Weekly Batch</h3>
                        <div style="display:flex; gap:.5rem; flex-wrap:wrap; align-items:center;">
                            <input id="sp_week" type="number" min="1" max="18" class="input" placeholder="Week (1-18)" style="max-width:140px;">
                            <select id="sp_season" class="input" style="max-width:160px;">
                                <option value="regular">regular</option>
                                <option value="preseason">preseason</option>
                            </select>
                            <button class="btn" onclick="runBatchFromModal()">Run Batch</button>
                            <label class="btn" for="sp_uploadBatch">Upload predictions_week_X.txt</label>
                            <input id="sp_uploadBatch" type="file" accept=".txt" style="display:none">
                            <span id="sp_batchFileName" style="color:#64748b"></span>
                        </div>
                        <div id="sp_batchList" style="margin-top:1rem; display:grid; gap:.75rem"></div>
                        <pre id="sp_batchOutput" style="margin-top:1rem; white-space:pre-wrap; font-family:Courier New, monospace; font-size:.9rem; line-height:1.5; background:#0b1220; color:#e5e7eb; padding:1rem; border-radius:10px; min-height:100px; overflow:auto;"></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Carousel Modal -->
    <div id="imageCarouselModal" class="modal" onclick="closeImageCarousel()">
        <div class="carousel-container" onclick="event.stopPropagation()">
            <span class="close" onclick="closeImageCarousel()">&times;</span>
            <div class="carousel-content">
                <button class="carousel-btn prev" onclick="changeImage(-1)">‚ùÆ</button>
                <img id="carouselImage" src="" alt="Screenshot">
                <button class="carousel-btn next" onclick="changeImage(1)">‚ùØ</button>
            </div>
            <div class="carousel-info">
                <span id="imageCounter"></span>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 Alexis Hirsch. Built with passion for web development.</p>
        </div>
    </footer>

    <script>
        // Image carousel functionality
        const samepathImages = [
            'Images/SamePath/1 - app loading on ExpoGo.png',
            'Images/SamePath/2 - Welcome.png',
            'Images/SamePath/3 - I_m New.png',
            'Images/SamePath/3 - I_m Returning.png'
        ];

        const sportspredictorImages = [
            'Images/sportsPredictor/BatchPredict.jpg',
            'Images/sportsPredictor/injuryExtract.jpg',
            'Images/sportsPredictor/injuryExtractData.jpg',
            'Images/sportsPredictor/updateData.jpg',
            'Images/sportsPredictor/updateDataData.jpg'
        ];

        let currentImageIndex = 0;
        let currentImageSet = [];

        function openImageCarousel(project) {
            if (project === 'samepath') {
                currentImageSet = samepathImages;
                currentImageIndex = 0;
                updateCarousel();
                document.getElementById('imageCarouselModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            } else if (project === 'sportspredictor') {
                currentImageSet = sportspredictorImages;
                currentImageIndex = 0;
                updateCarousel();
                document.getElementById('imageCarouselModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        async function openMatchupReport() {
            try {
                const response = await fetch('Images/sportsPredictor/DetailedMatchupReport.txt');
                const text = await response.text();
                
                // Create modal for text display
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.display = 'flex';
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        modal.remove();
                        document.body.style.overflow = 'auto';
                    }
                };

                const content = document.createElement('div');
                content.className = 'matchup-report-container';
                content.onclick = function(event) {
                    event.stopPropagation();
                };

                const header = document.createElement('div');
                header.innerHTML = `
                    <h2>Detailed Matchup Report</h2>
                    <span class="close" onclick="this.closest('.modal').remove(); document.body.style.overflow = 'auto';">&times;</span>
                `;
                header.style.display = 'flex';
                header.style.justifyContent = 'space-between';
                header.style.alignItems = 'center';
                header.style.marginBottom = '1.5rem';

                const textContent = document.createElement('pre');
                textContent.textContent = text;
                textContent.style.whiteSpace = 'pre-wrap';
                textContent.style.fontFamily = 'Courier New, monospace';
                textContent.style.fontSize = '0.9rem';
                textContent.style.lineHeight = '1.6';
                textContent.style.overflow = 'auto';
                textContent.style.maxHeight = '70vh';

                content.appendChild(header);
                content.appendChild(textContent);
                modal.appendChild(content);
                document.body.appendChild(modal);
                document.body.style.overflow = 'hidden';
            } catch (error) {
                alert('Could not load matchup report: ' + error.message);
            }
        }

        function closeImageCarousel() {
            document.getElementById('imageCarouselModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function changeImage(direction) {
            currentImageIndex += direction;
            if (currentImageIndex < 0) {
                currentImageIndex = currentImageSet.length - 1;
            } else if (currentImageIndex >= currentImageSet.length) {
                currentImageIndex = 0;
            }
            updateCarousel();
        }

        function updateCarousel() {
            const img = document.getElementById('carouselImage');
            img.src = currentImageSet[currentImageIndex];
            document.getElementById('imageCounter').textContent = `${currentImageIndex + 1} / ${currentImageSet.length}`;
        }

        // Keyboard navigation for carousel
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('imageCarouselModal').classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    changeImage(-1);
                } else if (e.key === 'ArrowRight') {
                    changeImage(1);
                } else if (e.key === 'Escape') {
                    closeImageCarousel();
                }
            }
        });
    </script>

    <style>
        .projects-showcase {
            display: flex;
            flex-direction: column;
            gap: 3rem;
            margin-top: 4rem;
        }

        .project-showcase-card {
            position: relative;
            height: 400px;
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .project-showcase-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
        }

        .showcase-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transition: all 0.4s ease;
        }

        .samepath-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .realestatehirsch-bg {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .sportspredictor-bg {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .project-showcase-card:hover .showcase-background {
            filter: brightness(1.1);
            transform: scale(1.05);
        }

        .showcase-content {
            position: relative;
            z-index: 2;
            height: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            padding: 3rem;
            color: white;
            gap: 3rem;
        }

        .showcase-content.layout-right {
            flex-direction: row-reverse;
        }

        .project-icon-large {
            font-size: 5rem;
            animation: float 3s ease-in-out infinite;
            flex-shrink: 0;
        }

        .project-text-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            text-align: left;
        }

        .showcase-content.layout-right .project-text-content {
            text-align: right;
        }

        .project-showcase-card h2 {
            font-size: 2.5rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            margin: 0;
        }

        .project-description {
            font-size: 1rem;
            opacity: 0.95;
            line-height: 1.6;
            margin: 0;
        }

        .showcase-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: flex-start;
            margin-top: 0.5rem;
        }

        .showcase-content.layout-right .showcase-buttons {
            justify-content: flex-end;
        }

        .showcase-buttons button,
        .showcase-buttons a {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-explore,
        .btn-screenshots {
            background: white;
            color: #667eea;
        }

        .btn-explore:hover,
        .btn-screenshots:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-live,
        .btn-github {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
        }

        .btn-live:hover,
        .btn-github:hover {
            background: white;
            color: #667eea;
            transform: translateY(-2px);
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-15px);
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal-content {
            background-color: #fff;
            padding: 3rem;
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .close {
            position: absolute;
            right: 1.5rem;
            top: 1.5rem;
            font-size: 2rem;
            font-weight: bold;
            color: #999;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #333;
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .modal-icon {
            font-size: 4rem;
        }

        .modal-header h2 {
            font-size: 2.5rem;
            color: #1e293b;
            margin: 0;
        }

        .modal-subtitle {
            color: #64748b;
            font-size: 1.2rem;
            margin: 0.5rem 0 0 0;
        }

        .modal-body {
            color: #475569;
            line-height: 1.8;
        }

        .modal-description {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            color: #475569;
        }

        .modal-body h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #1e293b;
            font-size: 1.5rem;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .feature-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
        }

        .modal-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }

            .modal-header {
                flex-direction: column;
                text-align: center;
            }

            .modal-header h2 {
                font-size: 2rem;
            }

            .modal-icon {
                font-size: 3rem;
            }
        }

        /* Image Carousel Styles */
        .carousel-container {
            background-color: #fff;
            max-width: 90vw;
            max-height: 90vh;
            border-radius: 15px;
            padding: 2rem;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .carousel-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
        }

        .carousel-content img {
            max-width: 600px;
            max-height: 70vh;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .carousel-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-btn:hover {
            background: #5568d3;
            transform: scale(1.1);
        }

        .carousel-info {
            margin-top: 1rem;
            color: #64748b;
            font-size: 1rem;
            font-weight: 600;
        }

        /* Matchup Report Container */
        .matchup-report-container {
            background-color: #fff;
            max-width: 80vw;
            max-height: 90vh;
            border-radius: 15px;
            padding: 2rem;
            overflow: auto;
        }

        .matchup-report-container h2 {
            color: #1e293b;
            margin: 0;
        }

        @media (max-width: 768px) {
            .carousel-container {
                padding: 1rem;
            }

            .carousel-content img {
                max-width: 90vw;
            }

            .carousel-btn {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .project-showcase-card {
                height: auto;
                min-height: 350px;
            }

            .showcase-content {
                flex-direction: column !important;
                gap: 2rem;
            }

            .showcase-content.layout-right {
                flex-direction: column !important;
            }

            .project-text-content {
                text-align: center !important;
            }

            .showcase-buttons {
                justify-content: center !important;
            }

            .project-icon-large {
                font-size: 4rem;
            }

            .project-showcase-card h2 {
                font-size: 2rem;
                text-align: center;
            }

            .project-description {
                font-size: 0.9rem;
                text-align: center;
            }

            .showcase-buttons button,
            .showcase-buttons a {
                padding: 0.8rem 1.5rem;
                font-size: 0.9rem;
            }
        }
    </style>

    <script>
        function openModal(projectName) {
            const modal = document.getElementById('modal-' + projectName);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(event, projectName) {
            const modal = document.getElementById('modal-' + projectName);
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Close modal with Escape key (but not for carousel)
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && !document.getElementById('imageCarouselModal').classList.contains('active')) {
                document.querySelectorAll('.modal.active').forEach(modal => {
                    modal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            }
        });

        // SportsPredictor handlers in modal
        async function runMatchupFromModal() {
            const homeTeam = document.getElementById('sp_homeTeam').value.trim();
            const awayTeam = document.getElementById('sp_awayTeam').value.trim();
            const neutral = document.getElementById('sp_neutral').checked;
            const out = document.getElementById('sp_matchupOutput');
            if (!homeTeam || !awayTeam) {
                out.textContent = 'Please enter both Home and Away teams.';
                return;
            }
            out.textContent = 'Running prediction...';
            try {
                const res = await fetch('/api/sports/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ league: 'NFL', homeTeam, awayTeam, neutral })
                });
                const text = await res.text();
                if (!res.ok) throw new Error(text);
                out.textContent = text;
            } catch (e) {
                out.textContent = 'Prediction failed or backend unavailable. ' + (e?.message || '');
            }
        }

        async function runBatchFromModal() {
            const w = parseInt((document.getElementById('sp_week').value || '').trim());
            const s = (document.getElementById('sp_season').value || 'regular').trim();
            const out = document.getElementById('sp_batchOutput');
            if (!Number.isFinite(w) || w < 1 || w > 18) {
                out.textContent = 'Enter a valid week (1-18).';
                return;
            }
            out.textContent = 'Running weekly batch...';
            try {
                const res = await fetch(`/api/sports/nfl/batch?week=${w}&season=${encodeURIComponent(s)}`);
                const text = await res.text();
                if (!res.ok) throw new Error(text);
                out.textContent = text;
            } catch (e) {
                out.textContent = 'Batch failed or backend unavailable. ' + (e?.message || '');
            }
        }

        // Upload viewer for predictions_week_X.txt inside modal
        const spUpload = document.getElementById('sp_uploadBatch');
        const spFileName = document.getElementById('sp_batchFileName');
        const spBatchList = document.getElementById('sp_batchList');
        spUpload && spUpload.addEventListener('change', (e) => {
            const file = e.target.files && e.target.files[0];
            if (!file) return;
            spFileName.textContent = 'Uploaded: ' + file.name;
            const reader = new FileReader();
            reader.onload = () => {
                const text = String(reader.result);
                const games = parseBatchSP(text);
                renderBatchSP(games);
            };
            reader.readAsText(file);
        });

        function parseBatchSP(text){
            const lines = text.split(/\r?\n/);
            const games = [];
            let current = null;
            for(const line of lines){
                if(/^Game\s+\d+:/i.test(line)){
                    if(current) games.push(current);
                    current = { meta: line.trim(), details: [] };
                } else if(line.trim()){
                    current && current.details.push(line.trim());
                }
            }
            if(current) games.push(current);
            return games;
        }
        function renderBatchSP(games){
            spBatchList.innerHTML = '';
            if(!games.length){
                spBatchList.innerHTML = '<p style="color:#94a3b8">No games parsed. Ensure you used predictions_week_X.txt.</p>';
                return;
            }
            for(const g of games){
                const card = document.createElement('div');
                card.style.background = '#0b1220';
                card.style.border = '1px solid #1f2937';
                card.style.borderRadius = '12px';
                card.style.padding = '1rem';
                card.innerHTML = `<div style="font-weight:700; color:#e2e8f0; margin-bottom:.5rem;">${g.meta}</div>` +
                                 `<div style="color:#cbd5e1; white-space:pre-wrap;">${g.details.join('\n')}</div>`;
                spBatchList.appendChild(card);
            }
        }
    </script>
</body>
</html>
