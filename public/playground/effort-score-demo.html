<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Effort Score Demo</title>

  <style>

    * {

      margin: 0;

      padding: 0;

      box-sizing: border-box;

    }



    :root {

      color-scheme: dark;

      --sky-400: #38bdf8;

      --sky-500: #0ea5e9;

      --emerald-400: #34d399;

      --emerald-500: #10b981;

      --orange-400: #fb923c;

      --orange-500: #f97316;

      --slate-300: #cbd5e1;

      --slate-400: #94a3b8;

      --slate-500: #64748b;

      --slate-700: #334155;

      --slate-800: #1e293b;

      --slate-900: #0f172a;

      --white: #ffffff;

    }



    body {

      background: radial-gradient(circle at 50% -20%, rgba(37,99,235,0.35), rgba(15,23,42,0.92));

      min-height: 100vh;

      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;

      color: var(--slate-300);

      line-height: 1.5;

    }



    .glass {

      background: rgba(15, 23, 42, 0.75);

      backdrop-filter: blur(18px);

      border: 1px solid rgba(148, 163, 184, 0.22);

    }



    .rounded-2xl { border-radius: 1rem; }

    .rounded-3xl { border-radius: 1.5rem; }

    .rounded-full { border-radius: 9999px; }



    .text-xs { font-size: 0.75rem; }

    .text-sm { font-size: 0.875rem; }

    .text-lg { font-size: 1.125rem; }

    .text-xl { font-size: 1.25rem; }

    .text-2xl { font-size: 1.5rem; }

    .text-3xl { font-size: 1.875rem; }

    .text-4xl { font-size: 2.25rem; }



    .font-medium { font-weight: 500; }

    .font-semibold { font-weight: 600; }

    .font-bold { font-weight: 700; }



    .flex { display: flex; }

    .grid { display: grid; }

    .hidden { display: none; }

    .items-center { align-items: center; }

    .items-end { align-items: flex-end; }

    .justify-center { justify-content: center; }

    .justify-between { justify-content: space-between; }

    .justify-start { justify-content: flex-start; }



    .gap-2 { gap: 0.5rem; }

    .gap-3 { gap: 0.75rem; }

    .gap-4 { gap: 1rem; }

    .gap-6 { gap: 1.5rem; }



    .space-y-3 > * + * { margin-top: 0.75rem; }

    .space-y-4 > * + * { margin-top: 1rem; }

    .space-y-6 > * + * { margin-top: 1.5rem; }



    .p-4 { padding: 1rem; }

    .p-5 { padding: 1.25rem; }

    .p-6 { padding: 1.5rem; }

    .p-8 { padding: 2rem; }

    .px-4 { padding-left: 1rem; padding-right: 1rem; }

    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }

    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }

    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }

    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }



    .mb-2 { margin-bottom: 0.5rem; }

    .mb-3 { margin-bottom: 0.75rem; }

    .mb-4 { margin-bottom: 1rem; }

    .mb-6 { margin-bottom: 1.5rem; }

    .mt-2 { margin-top: 0.5rem; }

    .mt-4 { margin-top: 1rem; }



    .w-full { width: 100%; }

    .w-12 { width: 3rem; }

    .w-16 { width: 4rem; }

    .w-20 { width: 5rem; }

    .h-12 { height: 3rem; }

    .h-16 { height: 4rem; }

    .h-20 { height: 5rem; }

    .h-\[500px\] { height: 500px; }

    .min-h-screen { min-height: 100vh; }



    .text-center { text-align: center; }

    .text-white { color: var(--white); }

    .text-sky-400 { color: var(--sky-400); }

    .text-orange-400 { color: var(--orange-400); }

    .text-emerald-400 { color: var(--emerald-400); }

    .text-slate-300 { color: var(--slate-300); }

    .text-slate-400 { color: var(--slate-400); }



    .bg-sky-500 { background-color: var(--sky-500); }

    .bg-emerald-500 { background-color: var(--emerald-500); }

    .bg-orange-500 { background-color: var(--orange-500); }

    .bg-slate-700 { background-color: var(--slate-700); }

    .bg-slate-800 { background-color: var(--slate-800); }

    .bg-slate-800\\/50 { background-color: rgba(30, 41, 59, 0.5); }

    .bg-sky-500\\/20 { background-color: rgba(14, 165, 233, 0.2); }

    .bg-emerald-500\\/20 { background-color: rgba(16, 185, 129, 0.2); }

    .bg-orange-500\\/20 { background-color: rgba(249, 115, 22, 0.2); }



    .border { border-width: 1px; }

    .border-slate-700 { border-color: var(--slate-700); }

    .border-emerald-500 { border-color: var(--emerald-500); }



    .cursor-pointer { cursor: pointer; }

    .transition-all { transition: all 0.3s ease; }



    .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }

    .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }

    .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }



    .col-span-2 { grid-column: span 2 / span 2; }



    .relative { position: relative; }

    .absolute { position: absolute; }

    .fixed { position: fixed; }

    .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }

    .bottom-6 { bottom: 1.5rem; }

    .right-6 { right: 1.5rem; }

    .z-50 { z-index: 50; }



    .max-w-md { max-width: 28rem; }

    .max-w-2xl { max-width: 42rem; }

    .max-h-\[90vh\] { max-height: 90vh; }



    .overflow-y-auto { overflow-y: auto; }



    @keyframes kpiPulse {

      0%, 100% { 

        box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.45); 

      }

      50% { 

        box-shadow: 0 0 0 18px rgba(74, 222, 128, 0); 

      }

    }



    .kpi-pulse {

      animation: kpiPulse 2s infinite;

    }



    .loading-spinner {

      border: 3px solid rgba(148, 163, 184, 0.3);

      border-radius: 50%;

      border-top: 3px solid var(--sky-400);

      width: 40px;

      height: 40px;

      animation: spin 1s linear infinite;

    }



    @keyframes spin {

      0% { transform: rotate(0deg); }

      100% { transform: rotate(360deg); }

    }



    button {

      background: rgba(15, 23, 42, 0.75);

      border: 1px solid rgba(148, 163, 184, 0.22);

      border-radius: 1rem;

      color: var(--slate-300);

      padding: 1rem 1.5rem;

      cursor: pointer;

      outline: none;

      transition: all 0.3s ease;

      font-size: 1rem;

      font-weight: 600;

    }



    button:hover {

      background: rgba(255, 255, 255, 0.1);

      transform: translateY(-2px);

    }



    button.primary {

      background: var(--sky-500);

      color: white;

      border: none;

    }



    button.primary:hover {

      background: var(--sky-400);

      transform: translateY(-2px);

    }



    .workout-card {

      transition: all 0.3s ease;

      cursor: pointer;

    }



    .workout-card:hover {

      transform: translateY(-4px);

      border-color: var(--sky-400);

    }



    .workout-card.selected {

      border-color: var(--emerald-500);

      background: rgba(16, 185, 129, 0.1);

    }



    .intensity-btn {

      padding: 0.75rem 1.5rem;

      border-radius: 2rem;

      border: 2px solid var(--slate-700);

      background: transparent;

      color: var(--slate-300);

      transition: all 0.3s ease;

    }



    .intensity-btn.selected {

      border-color: var(--sky-500);

      background: var(--sky-500);

      color: white;

    }



    .intensity-btn.easy { border-color: var(--emerald-500); }

    .intensity-btn.medium { border-color: var(--orange-500); }

    .intensity-btn.hard { border-color: #ef4444; }



    .intensity-btn.easy.selected { background: var(--emerald-500); }

    .intensity-btn.medium.selected { background: var(--orange-500); }

    .intensity-btn.hard.selected { background: #ef4444; }



    .progress-bar {

      width: 100%;

      height: 8px;

      background: var(--slate-700);

      border-radius: 4px;

      overflow: hidden;

    }



    .progress-fill {

      height: 100%;

      background: var(--emerald-500);

      transition: width 0.3s ease;

    }



    @media (min-width: 768px) {

      .md\\:p-6 { padding: 1.5rem; }

      .md\\:text-3xl { font-size: 1.875rem; }

      .md\\:flex-row { flex-direction: row; }

      .md\\:items-center { align-items: center; }

      .md\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }

      .md\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }

    }



    @media (min-width: 1024px) {

      .lg\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }

    }

  </style>

</head>

<body>

  <div id="root">

    <div class="flex flex-col items-center justify-center min-h-screen">

      <div class="glass rounded-3xl p-8 max-w-md text-center">

        <div class="loading-spinner mx-auto mb-4"></div>

        <h2 class="text-xl font-bold text-white mb-2">Starting Workout Tracker</h2>

        <p class="text-slate-400">Loading application...</p>

      </div>

    </div>

  </div>



  <script>

    function initializeApp() {

      // Utility functions

      const clamp = (value, min, max) => Math.max(min, Math.min(max, value));

      

      const computeZone = (hr) => {

        if (hr < 100) return { zone: 1, weight: 0.2 };

        if (hr < 120) return { zone: 2, weight: 0.4 };

        if (hr < 140) return { zone: 3, weight: 0.7 };

        if (hr < 160) return { zone: 4, weight: 1.0 };

        return { zone: 5, weight: 1.3 };

      };

      

      const computeEffort = (hr, acc, workoutType) => {

        const { weight } = computeZone(hr);

        const movementFactor = clamp(0.2 + 0.25 * acc, 0.0, 1.2);

        

        let hrWeight = weight;

        let movementWeight = movementFactor;

        

        // Adjust weights based on workout type

        if (workoutType === 'cardio') {

          hrWeight *= 1.15;

          movementWeight *= 0.9;

        } else if (workoutType === 'strength') {

          movementWeight *= 1.15;

          hrWeight *= 0.9;

        }

        

        return clamp(hrWeight * movementWeight * 100, 0, 100);

      };

      

      const formatDuration = (seconds) => {

        const mins = Math.floor(seconds / 60);

        const secs = seconds % 60;

        return `${mins}:${secs.toString().padStart(2, '0')}`;

      };



      // Application state

      const state = {

        // Workout selection

        selectedWorkout: null,

        selectedIntensity: 'medium',

        workoutDuration: 20, // minutes

        workoutProgress: 0,

        

        // Active workout

        isActive: false,

        isPaused: false,

        elapsedTime: 0,

        

        // Data

        data: [],

        metrics: {

          effortScore: 0,

          calories: 0,

          currentHeartRate: 0,

          currentMovement: 0

        }

      };



      // Workout definitions

      const workouts = {

        running: {

          name: "Running",

          type: "cardio",

          icon: "ðŸƒ",

          description: "Steady pace running",

          baseHR: 140,

          baseAcc: 0.8

        },

        cycling: {

          name: "Cycling", 

          type: "cardio",

          icon: "ðŸš´",

          description: "Stationary cycling",

          baseHR: 130,

          baseAcc: 0.6

        },

        weights: {

          name: "Weight Training",

          type: "strength", 

          icon: "ðŸ‹ï¸",

          description: "Free weights & machines",

          baseHR: 110,

          baseAcc: 1.2

        },

        hiit: {

          name: "HIIT",

          type: "mixed",

          icon: "âš¡", 

          description: "High intensity intervals",

          baseHR: 150,

          baseAcc: 1.5

        },

        yoga: {

          name: "Yoga",

          type: "mixed",

          icon: "ðŸ§˜",

          description: "Flow & holding poses",

          baseHR: 90,

          baseAcc: 0.3

        },

        boxing: {

          name: "Boxing",

          type: "strength",

          icon: "ðŸ¥Š",

          description: "Punching combinations",

          baseHR: 135,

          baseAcc: 1.8

        }

      };



      // Intensity multipliers

      const intensityMultipliers = {

        easy: { hr: 0.7, acc: 0.6 },

        medium: { hr: 1.0, acc: 1.0 },

        hard: { hr: 1.3, acc: 1.4 }

      };



      // Internal state

      let dataBuffer = [];

      let intervalId = null;

      let hrPhase = 0;

      let accPhase = 0;



      const BASE_INTERVAL_MS = 1000; // 1 second updates

      const MAX_BUFFER = 600; // 10 minutes of data



      // Data generation based on selected workout

      function generateWorkoutData() {

        if (!state.selectedWorkout) return { hr: 0, acc: 0 };

        

        const workout = workouts[state.selectedWorkout];

        const intensity = intensityMultipliers[state.selectedIntensity];

        

        // Base values from workout definition

        let baseHr = workout.baseHR * intensity.hr;

        let baseAcc = workout.baseAcc * intensity.acc;

        

        // Add variation based on workout type

        if (workout.type === 'cardio') {

          baseHr += 20 * Math.sin(hrPhase);

          baseAcc += 0.3 * Math.sin(accPhase);

        } else if (workout.type === 'strength') {

          // Simulate sets and reps - bursts of activity

          const inSet = Math.sin(hrPhase * 2) > 0.5;

          baseHr += inSet ? 25 : 5;

          baseAcc += inSet ? 0.8 : 0.2;

        } else {

          // Mixed workouts

          baseHr += 15 * Math.sin(hrPhase * 1.5);

          baseAcc += 0.5 * Math.sin(accPhase * 2);

        }

        

        // Add some random noise

        baseHr += (Math.random() - 0.5) * 10;

        baseAcc += (Math.random() - 0.5) * 0.2;

        

        hrPhase += 0.05;

        accPhase += 0.1;

        

        return {

          hr: clamp(baseHr, 60, 190),

          acc: clamp(baseAcc, 0, 4)

        };

      }



      function processTick() {

        if (!state.selectedWorkout || state.isPaused) return;

        

        const { hr, acc } = generateWorkoutData();

        const workout = workouts[state.selectedWorkout];

        const effortInstant = computeEffort(hr, acc, workout.type);

        

        const previousEma = dataBuffer.length > 0 

          ? dataBuffer[dataBuffer.length - 1].effortEma 

          : effortInstant;

        const effortEma = previousEma + 0.08 * (effortInstant - previousEma);

        

        const newPoint = {

          timestamp: new Date(),

          hr,

          acc,

          zone: computeZone(hr).zone,

          effortInstant,

          effortEma: clamp(effortEma, 0, 100)

        };

        

        dataBuffer = [...dataBuffer, newPoint].slice(-MAX_BUFFER);

        state.data = dataBuffer;

        

        // Update metrics

        const kcalPerMinute = 0.06 * hr + 0.5 * acc;

        state.metrics = {

          effortScore: newPoint.effortEma,

          calories: state.metrics.calories + (kcalPerMinute / 60),

          currentHeartRate: hr,

          currentMovement: acc

        };

        

        // Update progress

        state.elapsedTime += 1;

        state.workoutProgress = (state.elapsedTime / (state.workoutDuration * 60)) * 100;

        

        // Check if workout is complete

        if (state.elapsedTime >= state.workoutDuration * 60) {

          completeWorkout();

        }

        

        renderApp();

      }



      // Workout control functions

      function selectWorkout(workoutId) {

        state.selectedWorkout = workoutId;

        renderApp();

      }



      function setIntensity(intensity) {

        state.selectedIntensity = intensity;

        renderApp();

      }



      function setDuration(minutes) {

        state.workoutDuration = minutes;

        renderApp();

      }



      function startWorkout() {

        if (!state.selectedWorkout) {

          alert("Please select a workout first!");

          return;

        }

        

        // Reset state for new workout

        dataBuffer = [];

        state.data = [];

        state.elapsedTime = 0;

        state.workoutProgress = 0;

        state.metrics = {

          effortScore: 0,

          calories: 0,

          currentHeartRate: 0,

          currentMovement: 0

        };

        

        state.isActive = true;

        state.isPaused = false;

        

        intervalId = setInterval(processTick, BASE_INTERVAL_MS);

        renderApp();

      }



      function togglePause() {

        state.isPaused = !state.isPaused;

        renderApp();

      }



      function completeWorkout() {

        state.isActive = false;

        state.isPaused = false;

        if (intervalId) {

          clearInterval(intervalId);

          intervalId = null;

        }

        

        // Show completion message

        setTimeout(() => {

          alert(`Workout complete! ðŸŽ‰\n\nEffort Score: ${state.metrics.effortScore.toFixed(1)}\nCalories: ${state.metrics.calories.toFixed(0)}\nDuration: ${formatDuration(state.elapsedTime)}`);

        }, 500);

        

        renderApp();

      }



      function resetWorkout() {

        state.isActive = false;

        state.isPaused = false;

        state.elapsedTime = 0;

        state.workoutProgress = 0;

        state.metrics = {

          effortScore: 0,

          calories: 0,

          currentHeartRate: 0,

          currentMovement: 0

        };

        dataBuffer = [];

        state.data = [];

        

        if (intervalId) {

          clearInterval(intervalId);

          intervalId = null;

        }

        

        renderApp();

      }



      // Main rendering function

      function renderApp() {

        const workout = state.selectedWorkout ? workouts[state.selectedWorkout] : null;

        const currentData = state.data[state.data.length - 1] || { hr: 0, acc: 0, effortEma: 0 };



        const root = document.getElementById('root');

        

        if (!state.isActive) {

          // Workout selection screen

          root.innerHTML = `

            <div class="min-h-screen p-4 md:p-6">

              <header class="text-center mb-8">

                <h1 class="text-3xl font-bold text-white mb-2">Workout Tracker</h1>

                <p class="text-slate-400">Choose your workout and intensity</p>

              </header>

              

              <!-- Workout Selection -->

              <div class="glass rounded-3xl p-6 mb-6">

                <h2 class="text-xl font-semibold text-white mb-4">Choose Workout</h2>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">

                  ${Object.entries(workouts).map(([id, workout]) => `

                    <div 

                      class="workout-card glass rounded-2xl p-4 text-center cursor-pointer transition-all ${

                        state.selectedWorkout === id ? 'selected' : ''

                      }"

                      onclick="app.selectWorkout('${id}')"

                    >

                      <div class="text-3xl mb-2">${workout.icon}</div>

                      <div class="font-semibold text-white">${workout.name}</div>

                      <div class="text-xs text-slate-400 mt-1">${workout.description}</div>

                    </div>

                  `).join('')}

                </div>

              </div>

              

              <!-- Intensity & Duration -->

              ${state.selectedWorkout ? `

                <div class="glass rounded-3xl p-6 mb-6">

                  <h2 class="text-xl font-semibold text-white mb-4">Workout Settings</h2>

                  

                  <!-- Intensity -->

                  <div class="mb-6">

                    <h3 class="text-slate-400 mb-3">Intensity</h3>

                    <div class="flex gap-3 justify-center">

                      <button 

                        class="intensity-btn easy ${state.selectedIntensity === 'easy' ? 'selected' : ''}"

                        onclick="app.setIntensity('easy')"

                      >

                        Easy

                      </button>

                      <button 

                        class="intensity-btn medium ${state.selectedIntensity === 'medium' ? 'selected' : ''}"

                        onclick="app.setIntensity('medium')"

                      >

                        Medium

                      </button>

                      <button 

                        class="intensity-btn hard ${state.selectedIntensity === 'hard' ? 'selected' : ''}"

                        onclick="app.setIntensity('hard')"

                      >

                        Hard

                      </button>

                    </div>

                  </div>

                  

                  <!-- Duration -->

                  <div>

                    <h3 class="text-slate-400 mb-3">Duration: ${state.workoutDuration} minutes</h3>

                    <div class="flex gap-3 justify-center">

                      ${[10, 20, 30, 45, 60].map(minutes => `

                        <button 

                          class="intensity-btn ${state.workoutDuration === minutes ? 'selected' : ''}"

                          onclick="app.setDuration(${minutes})"

                        >

                          ${minutes}m

                        </button>

                      `).join('')}

                    </div>

                  </div>

                </div>

                

                <!-- Start Button -->

                <div class="text-center">

                  <button class="primary w-full max-w-md py-4 text-lg" onclick="app.startWorkout()">

                    Start ${workout.name} Workout

                  </button>

                </div>

              ` : `

                <div class="glass rounded-3xl p-8 text-center">

                  <p class="text-slate-400">Select a workout to begin</p>

                </div>

              `}

            </div>

          `;

        } else {

          // Active workout screen

          root.innerHTML = `

            <div class="min-h-screen p-4 md:p-6">

              <header class="flex justify-between items-center mb-6">

                <div>

                  <h1 class="text-2xl font-bold text-white">${workout.name}</h1>

                  <p class="text-slate-400">${state.selectedIntensity} intensity â€¢ ${state.workoutDuration} minutes</p>

                </div>

                <div class="text-right">

                  <div class="text-slate-400 text-sm">Time</div>

                  <div class="text-xl font-bold text-white">${formatDuration(state.elapsedTime)}</div>

                </div>

              </header>

              

              <!-- Progress Bar -->

              <div class="glass rounded-3xl p-6 mb-6">

                <div class="flex justify-between items-center mb-3">

                  <span class="text-slate-400">Workout Progress</span>

                  <span class="text-white font-semibold">${Math.round(state.workoutProgress)}%</span>

                </div>

                <div class="progress-bar">

                  <div class="progress-fill" style="width: ${state.workoutProgress}%"></div>

                </div>

              </div>

              

              <!-- Main Metrics -->

              <div class="grid grid-cols-2 gap-4 mb-6">

                <div class="glass rounded-3xl p-6 text-center">

                  <div class="text-3xl font-bold text-emerald-400 mb-2">${state.metrics.effortScore.toFixed(1)}</div>

                  <div class="text-slate-400">Effort Score</div>

                </div>

                <div class="glass rounded-3xl p-6 text-center">

                  <div class="text-3xl font-bold text-orange-400 mb-2">${state.metrics.calories.toFixed(0)}</div>

                  <div class="text-slate-400">Calories</div>

                </div>

              </div>

              

              <!-- Live Data -->

              <div class="glass rounded-3xl p-6 mb-6">

                <h2 class="text-xl font-semibold text-white mb-4">Live Data</h2>

                <div class="grid grid-cols-2 gap-4">

                  <div class="text-center">

                    <div class="text-2xl font-bold text-sky-400">${state.metrics.currentHeartRate.toFixed(0)}</div>

                    <div class="text-slate-400 text-sm">Heart Rate</div>

                  </div>

                  <div class="text-center">

                    <div class="text-2xl font-bold text-orange-400">${state.metrics.currentMovement.toFixed(2)}</div>

                    <div class="text-slate-400 text-sm">Movement (g)</div>

                  </div>

                </div>

              </div>

              

              <!-- Workout Controls -->

              <div class="flex gap-4">

                <button 

                  class="flex-1 py-4 ${state.isPaused ? 'primary' : ''}"

                  onclick="app.togglePause()"

                >

                  ${state.isPaused ? 'Resume' : 'Pause'}

                </button>

                <button 

                  class="flex-1 py-4 bg-slate-700"

                  onclick="app.completeWorkout()"

                >

                  Complete

                </button>

              </div>

            </div>

          `;

        }

      }



      // Expose functions globally

      window.app = {

        selectWorkout,

        setIntensity,

        setDuration,

        startWorkout,

        togglePause,

        completeWorkout,

        resetWorkout

      };



      // Initial render

      renderApp();

    }



    // Start the application

    setTimeout(initializeApp, 100);

  </script>

</body>

</html>